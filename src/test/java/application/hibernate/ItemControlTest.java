package application.hibernate;

import application.model.database.Items;
import application.model.database.User;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.Persistence;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

public class ItemControlTest{
    private final EntityManagerFactory emf = Persistence.createEntityManagerFactory("VulnerabilityDatabases");
    private UserControl userControl;
    private ItemControl itemControl;
    private User user;
    private Items items;

    @BeforeEach
    public void setup() {
        userControl = new UserControl(emf);
        itemControl = new ItemControl(emf);
        user = new User("name", "password", "saras@gmail.com", "salt");
        items = new Items("log", user);
    }

    @Test
    public void addItemsTest(){
        userControl.createUser(user);
        assertTrue(itemControl.addItem(items));
    }

    @Test
    public void getItemsTest() {
        userControl.createUser(user);
        itemControl.addItem(items);
        assertEquals(itemControl.getItems(user).size(), 1);
    }

    @Test
    public void deleteItemTest() {
        userControl.createUser(user);
        itemControl.addItem(items);
        assertTrue(itemControl.deleteItem(items.getId()));
    }
}
