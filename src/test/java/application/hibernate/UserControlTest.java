package application.hibernate;

import application.model.database.User;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.Persistence;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import java.security.NoSuchAlgorithmException;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

public class UserControlTest {
    private final EntityManagerFactory emf = Persistence.createEntityManagerFactory("VulnerabilityDatabases");
    private UserControl userControl;
    private User user;

    @BeforeEach
    public void setup() {
        userControl = new UserControl(emf);
        user = new User("name", "password", "saras@gmail.com", "salt");
    }

    @Test
    public void addUser() {
        assertTrue(userControl.createUser(user));
    }

    @Test
    public void getSalt() throws NoSuchAlgorithmException {
        assertEquals( userControl.getSalt().length(), 10);
    }

    @Test
    public void getHashedPassword() {
        assertEquals(userControl.getHashedPassword("123", "xd75vyDHcM"), "1fe44262c53a61e54904334082d1960f2132916dd3fa59444c7b16ea0d848e9d9eb8d6075a86611d7cb708018336854e7cf1211acb5b6e42b591b3dcd7b292aa");
    }
}
